---
title: "Secure Flexdashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
library(shiny)
library(shinyauthr)
library(dplyr)

# Hardcoded credentials (can be replaced with a secure source)
user_base <- data.frame(
  user = c("user1", "user2"),
  password = c("pass1", "pass2"),
  name = c("Alice", "Bob"),
  stringsAsFactors = FALSE
)


# Hardcoded credentials (can be replaced with a secure source)
user_base <- data.frame(
  user = c("user1", "user2"),
  password = c("pass1", "pass2"),
  name = c("Alice", "Bob"),
  stringsAsFactors = FALSE
)


# Login module UI
shinyauthr::loginUI("login")


# Reactive login module server
credentials <- shinyauthr::loginServer(
  id = "login",
  data = user_base,
  user_col = user,
  pwd_col = password,
  log_out = reactive(logout_init())
)

# Logout module server
logout_init <- shinyauthr::logoutServer("logout", reactive(credentials()$user_auth))

# Conditional UI based on login
output$main_ui <- renderUI({
  req(credentials()$user_auth)
  fluidRow(
    column(width = 12,
           h3(paste("Welcome,", credentials()$info$name)),
           actionButton("example", "Example Button")
    )
  )
})


uiOutput("main_ui")

```